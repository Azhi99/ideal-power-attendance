(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2161f4"],{c0b3:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"wrapper"}},[o("navbar",{staticClass:"no-print animate__animated animate__fadeInLeft",staticStyle:{display:"none"},attrs:{id:"nav"}}),o("div",{staticClass:"d-flex flex-column animate__animated animate__fadeInRight",staticStyle:{display:"none !important"},attrs:{id:"content-wrapper"}},[o("div",{attrs:{id:"content"}},[o("header-btn",{staticClass:"no-print"}),o("div",{staticClass:"container-fluid text-dark"},[t._m(0),o("hr"),o("div",{staticClass:"row"},[o("button",{staticClass:"btn btn-success col-xl-2 col-lg-2 col-md-2 col-sm-12",staticStyle:{height:"39px"},attrs:{"data-toggle":"modal","data-target":"#mdl_project"},on:{click:function(e){return t.clearProject()}}},[t._v(" Add Project "),o("i",{staticClass:"fa fa-plus"})]),o("button",{staticClass:"btn btn-warning col-xl-2 col-lg-2 col-md-2 ms-2 col-sm-12",staticStyle:{height:"39px"},attrs:{"data-toggle":"modal","data-target":"#mdl_staff_project"},on:{click:function(e){return t.clearStaffProject()}}},[t._v(" Staff Projects ")]),o("a",{staticClass:"btn btn-primary text-white col-xl-2 col-md-5 mx-2 mb-2",attrs:{href:"/work_projects_report"}},[t._v(" Report ")]),o("button",{staticClass:"btn btn-primary",staticStyle:{height:"39px"},attrs:{"data-toggle":"modal","data-target":"#mdlSortProjects"}},[o("v-icon",{attrs:{color:"white"}},[t._v(" mdi-sort ")])],1)])]),o("v-data-table",{staticClass:"mx-2 mt-3",attrs:{headers:t.headers,items:t.work_projects},scopedSlots:t._u([{key:"item.work_project_status",fn:function(e){var a=e.item;return["enabled"==a.work_project_status?o("v-btn",{attrs:{icon:"",color:"success"},on:{click:function(e){return t.updateStatus(a.work_project_id,"disabled")}}},[o("v-icon",[t._v(" fas fa-check ")])],1):o("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){return t.updateStatus(a.work_project_id,"enabled")}}},[o("v-icon",[t._v(" mdi-cancel ")])],1)]}},{key:"item.actions",fn:function(e){var a=e.item;return[o("v-btn",{attrs:{icon:"",color:"primary","data-toggle":"modal","data-target":"#mdl_project"},on:{click:function(e){return t.getSingleProject(a)}}},[o("v-icon",[t._v(" mdi-pencil ")])],1),o("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){return t.deleteProject(a)}}},[o("v-icon",[t._v(" mdi-delete ")])],1)]}}],null,!0)})],1)]),o("change-pass"),o("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdl_project"}},[o("div",{staticClass:"modal-dialog modal-md"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(e){return t.clearProject()}}},[t._v("×")]),o("h5",{staticClass:"mt-2"},[t._v("Project Information")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"container-fluid px-0"},[o("div",{staticClass:"row pe-4"},[o("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Project: ")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.work_project.work_project_name,expression:"work_project.work_project_name"}],staticClass:"form-control col-10",attrs:{type:"text"},domProps:{value:t.work_project.work_project_name},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.work_project.work_project_id?t.updateProject():t.addProject()},input:function(e){e.target.composing||t.$set(t.work_project,"work_project_name",e.target.value)}}})]),t.work_project.work_project_id?o("button",{staticClass:"btn btn-warning btn-block mt-3",attrs:{disabled:t.loading_add_project},on:{click:function(e){return t.updateProject()}}},[o("i",{staticClass:"fa fa-save"})]):o("button",{staticClass:"btn btn-success btn-block mt-3",attrs:{disabled:t.loading_add_project},on:{click:function(e){return t.addProject()}}},[o("i",{staticClass:"fa fa-plus"})])])])])])]),o("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdl_staff_project"}},[o("div",{staticClass:"modal-dialog modal-lg"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(e){return t.clearStaffProject()}}},[t._v("×")]),o("h5",{staticClass:"mt-2"},[t._v("Staff Projects")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"container-fluid px-0"},[o("div",{staticClass:"row pe-4"},[o("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Staff: ")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.staff_project.st_id,expression:"staff_project.st_id"}],staticClass:"form-control col-7",attrs:{disabled:""},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.staff_project,"st_id",e.target.multiple?o:o[0])}}},[o("option",{attrs:{value:""}}),t._l(t.staffs,(function(e){return o("option",{key:e.st_id,domProps:{value:e.st_id}},[t._v(" "+t._s(e.staff_name)+" ")])}))],2),o("span",{staticClass:"col-1"},[o("v-checkbox",{staticClass:"mt-0",attrs:{"true-value":"true","false-value":"false"},model:{value:t.showSpecialStaffs,callback:function(e){t.showSpecialStaffs=e},expression:"showSpecialStaffs"}})],1),o("span",{staticClass:"col-2",staticStyle:{"margin-top":"6px","margin-inline-start":"-29px"}},[t._v(" Specials ")])]),o("div",{staticClass:"row pe-4 mt-3"},[o("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Project: ")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.staff_project.work_project_id,expression:"staff_project.work_project_id"}],staticClass:"form-control col-10",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.staff_project,"work_project_id",e.target.multiple?o:o[0])}}},[o("option",{attrs:{value:""}}),t._l(t.work_projects,(function(e){return o("option",{key:e.work_project_id,domProps:{value:e.work_project_id}},[t._v(" "+t._s(e.work_project_name)+" ")])}))],2)]),o("button",{staticClass:"btn btn-warning btn-block mt-3",attrs:{disabled:!t.staff_project.staff_work_project_id},on:{click:function(e){return t.updateStaffProject()}}},[o("i",{staticClass:"fa fa-save"})]),o("v-data-table",{staticClass:"mt-3",attrs:{headers:t.staff_work_project_headers,items:t.filteredStaffProjects},scopedSlots:t._u([{key:"item.actions",fn:function(e){var a=e.item;return[o("v-btn",{attrs:{icon:"",color:"primary"},on:{click:function(e){return t.selectSingleStaffProject(a)}}},[o("v-icon",[t._v(" mdi-pencil ")])],1)]}}],null,!0)})],1)])])])]),o("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdlSortProjects"}},[o("div",{staticClass:"modal-dialog modal-md"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"}},[t._v("×")]),o("h5",{staticClass:"mt-2"},[t._v(" Sort Projects "),o("button",{staticClass:"btn btn-primary ms-2",on:{click:function(e){return t.saveProjectsSort()}}},[o("v-icon",{attrs:{color:"white"}},[t._v(" mdi-content-save ")])],1)])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"container-fluid"},[o("div",{staticStyle:{width:"100%"}},[o("draggable",{model:{value:t.projects_to_sort,callback:function(e){t.projects_to_sort=e},expression:"projects_to_sort"}},[o("transition-group",t._l(t.projects_to_sort,(function(e,a){return o("v-btn",{key:"emp"+a,staticClass:"mb-2",attrs:{block:"",color:"primary",elevation:"0"}},[t._v(" "+t._s(e.work_project_name)+" ")])})),1)],1)],1)])])])])])],1)},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"d-sm-flex justify-content-between align-items-center mb-4"},[o("h3",{staticClass:"text-dark mb-0"},[t._v(" Projects")])])}],s=o("b76a"),c=o.n(s),i=o("c735"),n=o("1ab6"),l={name:"work_projects",components:{draggable:c.a},data(){return{work_project:{work_project_id:null,work_project_name:null,work_project_status:null},work_projects:[],loading_add_project:!1,headers:[{text:"Project",align:"start",sortable:!0,value:"work_project_name"},{text:"Status",align:"start",sortable:!0,value:"work_project_status"},{text:"Actions",align:"start",sortable:!1,value:"actions"}],staff_work_project_headers:[{text:"Staff",align:"start",sortable:!0,value:"staff_name"},{text:"Project",align:"start",sortable:!0,value:"work_project_name"},{text:"Actions",align:"start",sortable:!1,value:"actions"}],staff_projects:[],staff_project:{staff_work_project_id:null,st_id:null,work_project_id:null},staffs:[],projects_to_sort:[],showSpecialStaffs:"false"}},beforeCreate(){Object(n["a"])("workProjects")},created(){this.$http.post("/staff/getData").then(({data:t})=>{this.staffs=t.filter(t=>"1"==t.show_staff)})},mounted(){this.$http.post("/work_projects/getData").then(t=>{this.work_projects=t.data,this.projects_to_sort=JSON.parse(JSON.stringify(this.work_projects.filter(t=>"enabled"==t.work_project_status))),this.$http.get("/work_projects/getStaffProjects").then(t=>{this.staff_projects=t.data})})},computed:{filteredStaffProjects(){return this.staff_projects.filter(t=>t.special_staff==this.showSpecialStaffs).sort((t,e)=>t.staff_sort_code-e.staff_sort_code)}},methods:{clearProject(){this.work_project={work_project_id:null,work_project_name:null,work_project_status:"enabled"}},addProject(){this.work_project.work_project_name?(this.loading_add_project=!0,this.$http.post("/work_projects/addProject",this.work_project).then(t=>{this.work_projects.push({work_project_id:t.data.work_project_id,work_project_name:this.work_project.work_project_name,work_project_status:this.work_project.work_project_status}),this.projects_to_sort.push({work_project_id:t.data.work_project_id,work_project_name:this.work_project.work_project_name,work_project_status:this.work_project.work_project_status}),this.clearProject()}).catch(()=>{alert("Failed to add project")}).finally(()=>{this.loading_add_project=!1})):alert("Please enter project name")},getSingleProject(t){this.work_project=JSON.parse(JSON.stringify(t))},updateProject(){this.work_project.work_project_name?(this.loading_add_project=!0,this.$http.patch("/work_projects/updateProject/"+this.work_project.work_project_id,this.work_project).then(()=>{const t=this.work_projects.findIndex(t=>t.work_project_id==this.work_project.work_project_id);this.$set(this.work_projects,t,JSON.parse(JSON.stringify(this.work_project))),alert("Project updated successfully")}).catch(()=>{alert("Failed to update project")}).finally(()=>{this.loading_add_project=!1})):alert("Please enter project name")},deleteProject(t){const e=confirm("Are you sure you want to delete this project?");e&&this.$http.delete("/work_projects/deleteProject/"+t.work_project_id).then(()=>{this.work_projects=this.work_projects.filter(e=>e.work_project_id!=t)}).catch(()=>{alert("Failed, Project may be used in other records")})},updateStatus(t,e){if("enabled"==e){const t=confirm("Are you sure you want to enable this project?");if(!t)return}else{const t=confirm("Are you sure you want to disable this project?");if(!t)return}this.$http.patch("/work_projects/updateStatus/"+t,{work_project_status:e}).then(()=>{const o=this.work_projects.findIndex(e=>e.work_project_id==t);this.$set(this.work_projects[o],"work_project_status",e),"enabled"==e?this.projects_to_sort.push(this.work_projects[o]):this.projects_to_sort=this.projects_to_sort.filter(e=>e.work_project_id!=t)}).catch(()=>{alert("Failed to update status")})},clearStaffProject(){this.staff_project={staff_work_project_id:null,st_id:null,work_project_id:null}},selectSingleStaffProject(t){this.staff_project=JSON.parse(JSON.stringify(t))},updateStaffProject(){this.staff_project.st_id&&this.staff_project.work_project_id?this.$http.patch("/work_projects/updateStaffProject/"+this.staff_project.staff_work_project_id,{work_project_id:this.staff_project.work_project_id}).then(()=>{const t=this.staff_projects.findIndex(t=>t.staff_work_project_id==this.staff_project.staff_work_project_id);this.$set(this.staff_projects[t],"work_project_id",this.staff_project.work_project_id),this.$set(this.staff_projects[t],"work_project_name",this.work_projects.find(t=>t.work_project_id==this.staff_project.work_project_id).work_project_name),alert("Staff project updated successfully")}).catch(()=>{alert("Failed to update staff project")}):alert("Please select staff and project")},saveProjectsSort(){this.$http.post("/work_projects/saveSortProjects",{list:this.projects_to_sort}).then(()=>{for(let t=0;t<this.projects_to_sort.length;t++){const e=this.work_projects.findIndex(e=>e.work_project_id==this.projects_to_sort[t].work_project_id);this.$set(this.work_projects[e],"sort_code",t)}this.work_projects=this.work_projects.sort((t,e)=>t.sort_code-e.sort_code),this.$alert("Successfully","Success","success")}).catch(t=>{Object(i["a"])(t)})}}},_=l,d=o("2877"),p=o("6544"),f=o.n(p),j=o("8336"),u=o("ac7c"),m=o("8fea"),k=o("132d"),w=Object(d["a"])(_,a,r,!1,null,null,null);e["default"]=w.exports;f()(w,{VBtn:j["a"],VCheckbox:u["a"],VDataTable:m["a"],VIcon:k["a"]})}}]);
//# sourceMappingURL=chunk-2d2161f4.b44ff4a9.js.map