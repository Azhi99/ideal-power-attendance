(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2a2d6e6"],{"14c4":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"wrapper"}},[e("navbar",{staticClass:"animate__animated animate__fadeInLeft",staticStyle:{display:"none"},attrs:{id:"nav"}}),e("div",{staticClass:"d-flex flex-column animate__animated animate__fadeInRight",staticStyle:{display:"none !important"},attrs:{id:"content-wrapper"}},[e("div",{attrs:{id:"content"}},[e("header-btn"),e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row no-print"},["A"==t.user.role?e("div",{staticClass:"col-1"},[e("button",{staticClass:"btn btn-success btn-block",attrs:{"data-toggle":"modal","data-target":"#mdlLoan"},on:{click:function(a){t.clear_loan(),t.employee_status_filter="1"}}},[t._v(" Add ")])]):t._e(),"A"==t.user.role||"K"==t.user.role?e("div",{staticClass:"col-2"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.archived_status,expression:"archived_status"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.archived_status=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"unarchived"}},[t._v(" Unarchived ")]),e("option",{attrs:{value:"archived"}},[t._v(" Archived ")])])]):t._e(),"A"==t.user.role||"K"==t.user.role?e("div",{staticClass:"col-2"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.type_filter,expression:"type_filter"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.type_filter=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"all"}},[t._v(" All ")]),e("option",{attrs:{value:"loan"}},[t._v(" Loan ")]),e("option",{attrs:{value:"accomodation"}},[t._v(" Accomodation ")]),e("option",{attrs:{value:"expense"}},[t._v(" Expense ")]),e("option",{attrs:{value:"fine"}},[t._v(" Fine ")]),e("option",{attrs:{value:"food"}},[t._v(" Food ")]),e("option",{attrs:{value:"transport"}},[t._v(" Transport ")])])]):t._e(),"A"==t.user.role?e("span",{staticClass:"col-1"},[e("v-checkbox",{staticClass:"mt-1 custom-checkbox-label",attrs:{"true-value":"true","false-value":"false",label:"Specials"},model:{value:t.showSpecialStaffs,callback:function(a){t.showSpecialStaffs=a},expression:"showSpecialStaffs"}})],1):t._e(),"A"==t.user.role?e("span",{staticClass:"ms-6",staticStyle:{"margin-top":"10px"}},[t._v(" Month: ")]):t._e(),"A"==t.user.role||"K"==t.user.role?e("div",{staticClass:"col-1"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.month,expression:"month"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.month=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:""}}),t._l(12,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(" "+t._s(a)+" ")])}))],2)]):t._e(),"A"==t.user.role?e("span",{staticClass:"ms-6",staticStyle:{"margin-top":"10px"}},[t._v(" Year: ")]):t._e(),"A"==t.user.role||"K"==t.user.role?e("div",{staticClass:"col-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.year,expression:"year"}],staticClass:"form-control",attrs:{type:"number",min:"2020"},domProps:{value:t.year},on:{input:function(a){a.target.composing||(t.year=a.target.value)}}})]):t._e(),"A"==t.user.role?e("div",{staticClass:"col-1"},[e("button",{staticClass:"btn btn-primary btn-block",on:{click:function(a){return t.print_all()}}},[t._v(" Print ")])]):t._e()]),"A"==t.user.role||"K"==t.user.role?e("v-data-table",{staticClass:"mt-3 no-print",attrs:{headers:t.headers,items:t.rows,"footer-props":{"items-per-page-options":[15,20,25,-1]}},scopedSlots:t._u([{key:"item.amount",fn:function(a){var o=a.item;return[e("span",{class:{"text-danger":o.amount<0}},[t._v(" "+t._s(o.amount.toLocaleString())+" "+t._s("Monthly"==o.salary_type?"$":"IQD.")+" ")])]}},{key:"item.datetime_create",fn:function(a){var e=a.item;return[t._v(" "+t._s(e.datetime_create&&t.isValidDate(e.datetime_create)?new Date(e.datetime_create).toISOString().split("T")[0]:"")+" "+t._s(e.datetime_create&&t.isValidDate(e.datetime_create)?new Date(e.datetime_create).toLocaleTimeString([],{timeZone:"America/Danmarkshavn",hour:"2-digit",minute:"2-digit"}):"")+" ")]}},{key:"item.la_date",fn:function(a){var e=a.item;return[t._v(" "+t._s(e.la_date&&t.isValidDate(e.la_date)?new Date(e.la_date).toISOString().split("T")[0]:"")+" ")]}},{key:"item.la_id",fn:function(a){var o=a.item;return[e("v-btn",{attrs:{icon:"",color:"success","data-toggle":"modal","data-target":"#mdlView"},on:{click:function(a){t.employee_status_filter=null,t.getSingleLoanAccomodation(o)}}},[e("v-icon",{attrs:{size:"23"}},[t._v(" mdi-eye ")])],1),"A"==t.user.role?e("v-btn",{attrs:{icon:"",color:"primary","data-toggle":"modal","data-target":"#mdlLoan"},on:{click:function(a){t.employee_status_filter=null,t.getSingleLoanAccomodation(o)}}},[e("v-icon",{attrs:{size:"23"}},[t._v(" mdi-pencil ")])],1):t._e(),"A"==t.user.role?e("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(a){return t.delete_list(o.la_id)}}},[e("v-icon",[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)}):e("table",{staticClass:"table table-bordered table-striped text-center text-dark"},[e("thead",[e("tr",[e("th",[t._v(" Employee ")]),e("th",[t._v(" Staff ")]),e("th",[t._v(" Type ")]),e("th",[t._v(" Amount ")]),e("th",[t._v(" User ")]),e("th",[t._v(" Date - Time ")]),e("th",[t._v(" Actions ")])])]),e("tbody",t._l(t.rows,(function(a,o){return e("tr",{key:o},[e("td",[t._v(" "+t._s(a.employee_full_name)+" ")]),e("td",[t._v(" "+t._s(a.staff_name)+" ")]),e("td",[t._v(" "+t._s(a.la_type)+" ")]),e("td",{class:{"text-danger":a.amount<0}},[t._v(" "+t._s(a.amount.toLocaleString())+" "+t._s("Monthly"==a.salary_type?"$":"IQD.")+" ")]),e("td",[t._v(" "+t._s(a.user)+" ")]),e("td",[t._v(" "+t._s(a.datetime_create&&t.isValidDate(a.datetime_create)?new Date(a.datetime_create).toISOString().split("T")[0]:"")+" "+t._s(a.datetime_create&&t.isValidDate(a.datetime_create)?new Date(a.datetime_create).toLocaleTimeString([],{timeZone:"America/Danmarkshavn",hour:"2-digit",minute:"2-digit"}):"")+" ")]),e("td",[e("v-btn",{attrs:{icon:"",color:"success","data-toggle":"modal","data-target":"#mdlView"},on:{click:function(e){return t.getSingleLoanAccomodation(a)}}},[e("v-icon",{attrs:{size:"23"}},[t._v(" mdi-eye ")])],1)],1)])})),0)])],1),e("hr",{staticClass:"no-print"}),"A"==t.user.role?e("table",{staticClass:"table table-bordered  text-center text-dark table-only-print"},[t._m(0),e("tbody",[t._l(Array.from(new Set(t.all_rows.filter((function(a){return a.special_staff==t.showSpecialStaffs})).map((function(t){return t.st_id})))),(function(a,o){return[e("tr",{key:"ss"+o},[e("td",{staticClass:"text-start",staticStyle:{"background-color":"#EBEBF0 !important",color:"blue"},attrs:{colspan:"4"}},[t._v(" "+t._s(t.staffs.find((function(t){return t.st_id==a})).staff_name)+" ")])]),t._l(Array.from(t.removeDuplicateObjects(t.all_rows.filter((function(t){return t.st_id==a})).map((function(t){return{emp_id:t.emp_id,la_id:t.la_id}})))),(function(a,o){return[e("tr",{key:"se"+a.emp_id+a.la_id+o},[e("td",{staticClass:"text-start",staticStyle:{"background-color":"#EBEBF0 !important",color:"black","font-weight":"500"},attrs:{colspan:"4"}},[t._v(" "+t._s(t.all_rows.find((function(t){return t.emp_id==a.emp_id})).employee_full_name)+" ")])]),e("tr",{key:"sn"+a.emp_id+a.la_id+o+1},[e("td",{staticClass:"text-start",staticStyle:{"background-color":"#EBEBF0 !important",color:"black","font-weight":"500","white-space":"pre","font-size":"11pt"},attrs:{colspan:"4"}},[t._v(t._s(t.all_rows.find((function(t){return t.emp_id==a.emp_id&&t.la_id==a.la_id})).note))])]),t._l(t.all_rows.filter((function(t){return t.emp_id==a.emp_id&&t.la_id==a.la_id})),(function(a,o){return e("tr",{key:"data"+a.la_id+o},[e("td",[t._v(" "+t._s(a.la_type)+" ")]),e("td",{class:{"text-danger":a.amount<0}},[t._v(" "+t._s(a.amount.toLocaleString())+" "+t._s("Monthly"==a.salary_type?"$":"IQD.")+" ")]),e("td",[t._v(" "+t._s(a.month)+" ")]),e("td",[t._v(" "+t._s(a.year)+" ")])])}))]}))]}))],2)]):t._e()],1)]),e("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdlLoan"}},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(a){return t.clear_loan()}}},[t._v("×")]),e("h5",{staticClass:"mt-2"},[t._v(" Loan / Accomodation / Expense ")])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Staffs: ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.staff_id,expression:"loan_accomodation.staff_id"}],staticClass:"form-control col-sm-8 mb-2",attrs:{id:"staff-select"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.loan_accomodation,"staff_id",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:""}}),t._l(t.staffs.filter((function(a){return"1"==a.show_staff&&a.special_staff==t.showSpecialStaffs})),(function(a){return e("option",{key:a.st_id,domProps:{value:a.st_id}},[t._v(" "+t._s(a.staff_name)+" ")])}))],2)]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Employee: ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.emp_id,expression:"loan_accomodation.emp_id"}],staticClass:"form-control col-sm-8 mb-2",attrs:{id:"employee-select"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.loan_accomodation,"emp_id",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:""}}),t._l(t.employees.filter((function(a){return!t.employee_status_filter||a.active_status==t.employee_status_filter})),(function(a){return e("option",{key:a.emp_id,domProps:{value:a.emp_id}},[t._v(" "+t._s(a.full_name)+" ")])}))],2),e("label",{staticClass:"col-sm-2 mt-1"},[t._v(" "+t._s(t._f("country_filter")(t.region))+" ")])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Type: ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.la_type,expression:"loan_accomodation.la_type"}],staticClass:"form-control col-sm-8 mb-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.loan_accomodation,"la_type",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"loan"}},[t._v(" Loan ")]),e("option",{attrs:{value:"accomodation"}},[t._v(" Accomodation ")]),e("option",{attrs:{value:"expense"}},[t._v(" Expense ")]),e("option",{attrs:{value:"fine"}},[t._v(" Fine ")]),e("option",{attrs:{value:"food"}},[t._v(" Food ")]),e("option",{attrs:{value:"transport"}},[t._v(" Transport ")])])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Salary type: ")]),e("label",{staticClass:"col-sm-8 mt-2"},[t._v(" "+t._s(t.loan_accomodation.salary_type)+" ")])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Amount: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.amount,expression:"loan_accomodation.amount"}],staticClass:"form-control col-sm-8 mb-2",attrs:{type:"number"},domProps:{value:t.loan_accomodation.amount},on:{input:function(a){a.target.composing||t.$set(t.loan_accomodation,"amount",a.target.value)}}}),e("label",{staticClass:"col-sm-1 mt-2"},[t._v(" "+t._s(t.loan_accomodation.emp_id?"Monthly"==t.employees.find((function(a){return a.emp_id==t.loan_accomodation.emp_id})).salary_type?"$":"IQD.":"")+" ")])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-12 mt-2"},[t._v(" Remain: "),e("span",{staticClass:"ml-14"},[t._v(" ( "+t._s((Number(t.loan_accomodation.amount)-Number(t.list.reduce((function(t,a){return t+Number(a.amount)}),0))).toLocaleString())+" ) ")])])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Date: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.la_date,expression:"loan_accomodation.la_date"}],staticClass:"form-control col-sm-8 mb-2",attrs:{type:"date"},domProps:{value:t.loan_accomodation.la_date},on:{input:function(a){a.target.composing||t.$set(t.loan_accomodation,"la_date",a.target.value)}}})]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Archived: ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.archived,expression:"loan_accomodation.archived"}],staticClass:"form-control col-sm-8 mb-2",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.loan_accomodation,"archived",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"unarchived"}},[t._v(" Unarchived ")]),e("option",{attrs:{value:"archived"}},[t._v(" Archived ")])])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 mt-2"},[t._v(" Note: ")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.loan_accomodation.note,expression:"loan_accomodation.note"}],staticClass:"form-control col-sm-10 mb-2",attrs:{rows:"3"},domProps:{value:t.loan_accomodation.note},on:{input:function(a){a.target.composing||t.$set(t.loan_accomodation,"note",a.target.value)}}})]),e("div",{staticClass:"row"},[e("button",{staticClass:"btn btn-success col-sm-2 mt-2",on:{click:function(a){return t.push_item_list()}}},[e("v-icon",{attrs:{color:"white"}},[t._v(" mdi-plus ")])],1)]),e("hr"),t._m(1),t._l(t.list,(function(a,o){return e("div",{key:"l"+o,staticClass:"row"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.amount,expression:"item.amount"}],staticClass:"form-control col-sm-3 mb-2",domProps:{value:a.amount},on:{change:function(e){return t.set_amount(a.lad_id||null,a.amount)},input:function(e){e.target.composing||t.$set(a,"amount",e.target.value)}}}),e("select",{directives:[{name:"model",rawName:"v-model",value:a.month,expression:"item.month"}],staticClass:"form-control col-sm-3 mb-2",on:{change:[function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(a,"month",e.target.multiple?o:o[0])},function(e){return t.set_month(a.lad_id||null,a.month)}]}},[e("option",{attrs:{value:""}}),e("option",{attrs:{value:"1"}},[t._v(" 1 ")]),e("option",{attrs:{value:"2"}},[t._v(" 2 ")]),e("option",{attrs:{value:"3"}},[t._v(" 3 ")]),e("option",{attrs:{value:"4"}},[t._v(" 4 ")]),e("option",{attrs:{value:"5"}},[t._v(" 5 ")]),e("option",{attrs:{value:"6"}},[t._v(" 6 ")]),e("option",{attrs:{value:"7"}},[t._v(" 7 ")]),e("option",{attrs:{value:"8"}},[t._v(" 8 ")]),e("option",{attrs:{value:"9"}},[t._v(" 9 ")]),e("option",{attrs:{value:"10"}},[t._v(" 10 ")]),e("option",{attrs:{value:"11"}},[t._v(" 11 ")]),e("option",{attrs:{value:"12"}},[t._v(" 12 ")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.year,expression:"item.year"}],staticClass:"form-control col-sm-3 mb-2",attrs:{type:"number"},domProps:{value:a.year},on:{change:function(e){return t.set_year(a.lad_id||null,a.year)},input:function(e){e.target.composing||t.$set(a,"year",e.target.value)}}}),e("v-btn",{staticClass:"col-sm-3 mb-2 text-center",attrs:{color:"error"},on:{click:function(a){return t.delete_item_list(o)}}},[e("v-icon",[t._v(" mdi-delete ")])],1)],1)})),e("div",{staticClass:"row"},[t.loan_accomodation.la_id?e("button",{staticClass:"btn btn-warning btn-block mx-2 mt-8",on:{click:function(a){return t.updateList()}}},[t._v(" Update "),e("v-icon",{attrs:{color:"white"}},[t._v(" mdi-content-save ")])],1):e("button",{staticClass:"btn btn-success btn-block mx-2 mt-8",on:{click:function(a){return t.addList()}}},[t._v(" Add List "),e("v-icon",{attrs:{color:"white"}},[t._v(" mdi-plus ")])],1)])],2)])])]),e("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdlView"}},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(a){return t.clear_loan()}}},[t._v("×")]),e("h5",{staticClass:"mt-2"},[t._v(" Loan / Accomodation ")])]),e("div",{staticClass:"modal-body"},[t._v(" Employee: "+t._s(t.employee_full_name)+" "),e("br"),e("br"),t._v(" Country: "+t._s(t._f("country_filter")(t.region))+" "),e("br"),e("br"),t._v(" Staff: "+t._s(t.loan_accomodation.staff_id?t.staffs.find((function(a){return a.st_id==t.loan_accomodation.staff_id})).staff_name:"")+" "),e("br"),e("br"),t._v(" Type: "+t._s(t.loan_accomodation.la_type)+" "),e("br"),e("br"),t._v(" Total: "),e("span",{class:{"text-danger":t.loan_accomodation.amount<0}},[t._v(" "+t._s((t.loan_accomodation.amount>0?t.loan_accomodation.amount:-1*t.loan_accomodation.amount).toLocaleString())+" "+t._s("Monthly"==t.loan_accomodation.salary_type?"$":"IQD.")+" ")]),e("br"),e("br"),t._v(" Note: "),e("br"),e("hr"),e("div",{staticStyle:{"white-space":"pre !important"}},[t._v(t._s(t.loan_accomodation.note))]),e("table",{staticClass:"table table-bordered table-striped text-center text-dark mt-3"},[t._m(2),e("tbody",t._l(t.list,(function(a){return e("tr",{key:a.lad_id},[e("td",[e("span",{class:{"text-danger":a.amount<0}},[t._v(" "+t._s(a.amount.toLocaleString())+" "+t._s("Monthly"==t.loan_accomodation.salary_type?"$":"IQD.")+" ")])]),e("td",[t._v(" "+t._s(a.month)+" ")]),e("td",[t._v(" "+t._s(a.year)+" ")])])})),0)])])])])])],1)},n=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{staticStyle:{color:"black"}},[t._v(" Type ")]),e("th",{staticStyle:{color:"black"}},[t._v(" Amount ")]),e("th",{staticStyle:{color:"black"}},[t._v(" Month ")]),e("th",{staticStyle:{color:"black"}},[t._v(" Year ")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-3 mb-2 text-center"},[t._v(" Amount ")]),e("label",{staticClass:"col-sm-3 mb-2 text-center"},[t._v(" Month ")]),e("label",{staticClass:"col-sm-3 mb-2 text-center"},[t._v(" Year ")]),e("label",{staticClass:"col-sm-3 mb-2 text-center"},[t._v(" Actions ")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v(" Amount ")]),e("th",[t._v(" Month ")]),e("th",[t._v(" Year ")])])])}],l=e("1ab6"),i={name:"LoanAccomodation",data(){return{employee_status_filter:null,region:"",staffs:[],employees:[],employee_full_name:"",archived_status:"unarchived",loan_accomodation:{la_id:null,staff_id:null,emp_id:null,la_type:"loan",salary_type:null,amount:0,note:null,la_date:(new Date).toISOString().split("T")[0],archived:"unarchived"},type_filter:"all",month:"",year:null,list:[],rows:[],all_rows:[],user:{username:"",role:"",en_id:null},headers:[{text:"Employee",align:"start",sortable:!1,value:"employee_full_name"},{text:"Staff",align:"start",sortable:!1,value:"staff_name"},{text:"Type",align:"start",sortable:!1,value:"la_type"},{text:"Amount",align:"start",sortable:!0,value:"amount"},{text:"User",align:"start",sortable:!1,value:"user"},{text:"Date (Create)",align:"start",sortable:!1,value:"la_date"},{text:"Date - Time",align:"start",sortable:!0,value:"datetime_create"},{text:"Actions",align:"start",sortable:!1,value:"la_id"}],showSpecialStaffs:"false"}},beforeCreate(){Object(l["a"])("LoanAccomodation")},created(){this.$http.post("/getLoggedInfo").then(({data:t})=>{this.user.username=t.username,this.user.role=t.type,this.user.en_id=t.en_id||null,this.$http.post("/staff/getData").then(({data:t})=>{this.staffs=t.sort((t,a)=>t.staff_sort_code-a.staff_sort_code)}),this.getData()})},methods:{getData(){"E"==this.user.role?this.$http.get("/loan_accomodation/getByEngineer/"+this.type_filter+"/"+this.user.en_id+"/"+this.archived_status).then(t=>{this.rows=t.data}):this.$http.post("/loan_accomodation/all",{filter:this.type_filter,archived:this.archived_status,year:this.year,month:this.month}).then(t=>{this.rows=t.data})},clear_loan(){this.loan_accomodation={la_id:null,staff_id:null,emp_id:null,la_type:"loan",salary_type:null,amount:0,note:null,la_date:(new Date).toISOString().split("T")[0],archived:"unarchived"},this.list=[]},delete_item_list(t){this.$confirm("Are you sure you want to delete this item ?","","question").then(()=>{if(this.loan_accomodation.la_id){const a=this.list[t].lad_id;this.$http.delete("/loan_accomodation/delete_detail_by_id/"+a).then(()=>{this.list.splice(t,1)}).catch(()=>{alert("Delete Failed")})}else this.list.splice(t,1)})},addList(){var t=new Date;t.setHours(t.getHours()+3);const a=this.list.filter(t=>t.amount&&t.month&&t.year);return 0==a.length?alert("Please fill all fields"):this.loan_accomodation.emp_id&&this.loan_accomodation.staff_id&&this.loan_accomodation.amount?void this.$http.post("/loan_accomodation/create_list",{loan_accomodation:{emp_id:this.loan_accomodation.emp_id,st_id:this.loan_accomodation.staff_id,la_type:this.loan_accomodation.la_type,amount:this.loan_accomodation.amount,salary_type:this.loan_accomodation.salary_type,datetime_create:t,user:this.user.username,note:this.loan_accomodation.note,la_date:this.loan_accomodation.la_date,archived:this.loan_accomodation.archived},list:a}).then(()=>{this.getData(),this.clear_loan()}):alert("Please all fields")},updateList(){const t=this.list.filter(t=>t.amount&&t.month&&t.year);if(0==t.length)return alert("Please fill all fields");if(!this.loan_accomodation.emp_id||!this.loan_accomodation.staff_id||!this.loan_accomodation.amount)return alert("Please all fields");var a=new Date;a.setHours(a.getHours()+3),this.$http.patch("/loan_accomodation/update_list",{loan_accomodation:{la_id:this.loan_accomodation.la_id,emp_id:this.loan_accomodation.emp_id,st_id:this.loan_accomodation.staff_id,la_type:this.loan_accomodation.la_type,amount:this.loan_accomodation.amount,salary_type:this.loan_accomodation.salary_type,datetime_create:a,user:this.user.username,note:this.loan_accomodation.note,la_date:this.loan_accomodation.la_date,archived:this.loan_accomodation.archived}}).then(()=>{this.getData(),this.clear_loan()})},getSingleLoanAccomodation(t){this.loan_accomodation={la_id:null,staff_id:null,emp_id:null,la_type:"loan",salary_type:null,amount:0,note:null,la_date:(new Date).toISOString().split("T")[0],archived:"unarchived"},this.list=[],this.loan_accomodation.la_id=t.la_id,this.loan_accomodation.staff_id=t.st_id,setTimeout(()=>{this.loan_accomodation.emp_id=t.emp_id,this.region=t.country},200),this.loan_accomodation.la_type=t.la_type,this.loan_accomodation.salary_type=t.salary_type,this.loan_accomodation.amount=t.amount,this.loan_accomodation.note=t.note,this.loan_accomodation.la_date=new Date(t.la_date).toISOString().split("T")[0],this.loan_accomodation.archived=t.archived,this.employee_full_name=t.employee_full_name,this.$http.get("/loan_accomodation/get_detail/"+t.la_id).then(t=>{this.list=t.data})},delete_list(t){this.$confirm("Are you sure you want to delete this list ?","","question").then(()=>{this.$http.delete("/loan_accomodation/delete_by_id/"+t).then(()=>{this.getData()}).catch(()=>{alert("Delete Failed")})})},set_amount(t,a){this.loan_accomodation.la_id&&this.$http.patch("/loan_accomodation/set_amount/"+t,{amount:a}).then(()=>{}).catch(()=>{alert("Update Failed")})},set_month(t,a){this.loan_accomodation.la_id&&this.$http.patch("/loan_accomodation/set_month/"+t,{month:a}).then(()=>{}).catch(()=>{alert("Update Failed")})},set_year(t,a){this.loan_accomodation.la_id&&this.$http.patch("/loan_accomodation/set_year/"+t,{year:a}).then(()=>{}).catch(()=>{alert("Update Failed")})},push_item_list(){this.loan_accomodation.la_id?this.$http.post("/loan_accomodation/add_detail",{la_id:this.loan_accomodation.la_id,amount:0,month:(new Date).getMonth()+1,year:(new Date).getFullYear()}).then(t=>{this.list.push({lad_id:t.data.new_id,la_id:this.loan_accomodation.la_id,amount:0,month:(new Date).getMonth()+1,year:(new Date).getFullYear()})}).catch(()=>{alert("Add Failed")}):this.list.push({la_id:null,amount:0,month:null,year:(new Date).getFullYear()})},isValidDate(t){let a=new Date(t);return a instanceof Date&&!isNaN(a)},print_all(){this.all_rows=[];let t=this.rows.map(t=>t.la_id);this.$http.post("/loan_accomodation/getAllDetailByIds",{ids:t}).then(t=>{this.all_rows=t.data,setTimeout(()=>{window.print()},500)})},removeDuplicateObjects(t){const a=[],e=new Set;for(const o of t){const t=JSON.stringify(o);e.has(t)||(e.add(t),a.push(o))}return a}},watch:{"loan_accomodation.staff_id":function(t){this.employees=[],this.loan_accomodation.emp_id=null,t?this.$http.post("/employee/getEmployeeBystaffForLoan/"+this.loan_accomodation.staff_id).then(({data:t})=>{this.employees=t}):this.employees=[]},"loan_accomodation.emp_id":function(t){document.activeElement==document.getElementById("employee-select")&&(t?(this.region=this.employees.find(a=>a.emp_id==t).country,this.loan_accomodation.salary_type=this.employees.find(a=>a.emp_id==t).salary_type):(this.region="",this.loan_accomodation.salary_type=null))},archived_status(){this.getData()},type_filter(){this.getData()},month(){this.getData()},year(){this.getData()}},filters:{country_filter(t){return{1:"Iraq",2:"Foreign",3:"Iran",4:"Bangladish",5:"Syria",6:"India",7:"Pakistan"}[t]}}},s=i,r=(e("3c33"),e("2877")),c=e("6544"),d=e.n(c),_=e("8336"),m=e("ac7c"),u=e("8fea"),p=e("132d"),v=Object(r["a"])(s,o,n,!1,null,"140ba7d4",null);a["default"]=v.exports;d()(v,{VBtn:_["a"],VCheckbox:m["a"],VDataTable:u["a"],VIcon:p["a"]})},"3c33":function(t,a,e){"use strict";e("9ed0")},"9ed0":function(t,a,e){}}]);
//# sourceMappingURL=chunk-d2a2d6e6.2d697c47.js.map