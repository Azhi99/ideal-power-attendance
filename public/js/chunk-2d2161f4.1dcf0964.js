(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2161f4"],{c0b3:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"wrapper"}},[a("navbar",{staticClass:"no-print animate__animated animate__fadeInLeft",staticStyle:{display:"none"},attrs:{id:"nav"}}),a("div",{staticClass:"d-flex flex-column animate__animated animate__fadeInRight",staticStyle:{display:"none !important"},attrs:{id:"content-wrapper"}},[a("div",{attrs:{id:"content"}},[a("header-btn",{staticClass:"no-print"}),a("div",{staticClass:"container-fluid text-dark"},[t._m(0),a("hr"),a("div",{staticClass:"row"},[a("button",{staticClass:"btn btn-success col-xl-2 col-lg-2 col-md-2 col-sm-12",staticStyle:{height:"39px"},attrs:{"data-toggle":"modal","data-target":"#mdl_project"},on:{click:function(e){return t.clearProject()}}},[t._v(" Add Project "),a("i",{staticClass:"fa fa-plus"})]),a("button",{staticClass:"btn btn-warning col-xl-2 col-lg-2 col-md-2 ms-2 col-sm-12",staticStyle:{height:"39px"},attrs:{"data-toggle":"modal","data-target":"#mdl_staff_project"},on:{click:function(e){return t.clearStaffProject()}}},[t._v(" Staff Projects ")]),a("a",{staticClass:"btn btn-primary text-white col-xl-2 col-md-5 mx-2 mb-2",attrs:{href:"/work_projects_report"}},[t._v(" Report ")])])]),a("v-data-table",{staticClass:"mx-2 mt-3",attrs:{headers:t.headers,items:t.work_projects},scopedSlots:t._u([{key:"item.work_project_status",fn:function(e){var o=e.item;return["enabled"==o.work_project_status?a("v-btn",{attrs:{icon:"",color:"success"},on:{click:function(e){return t.updateStatus(o.work_project_id,"disabled")}}},[a("v-icon",[t._v(" fas fa-check ")])],1):a("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){return t.updateStatus(o.work_project_id,"enabled")}}},[a("v-icon",[t._v(" mdi-cancel ")])],1)]}},{key:"item.actions",fn:function(e){var o=e.item;return[a("v-btn",{attrs:{icon:"",color:"primary","data-toggle":"modal","data-target":"#mdl_project"},on:{click:function(e){return t.getSingleProject(o)}}},[a("v-icon",[t._v(" mdi-pencil ")])],1),a("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){return t.deleteProject(o)}}},[a("v-icon",[t._v(" mdi-delete ")])],1)]}}],null,!0)})],1)]),a("change-pass"),a("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdl_project"}},[a("div",{staticClass:"modal-dialog modal-md"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(e){return t.clearProject()}}},[t._v("×")]),a("h5",{staticClass:"mt-2"},[t._v("Project Information")])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"container-fluid px-0"},[a("div",{staticClass:"row pe-4"},[a("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Project: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.work_project.work_project_name,expression:"work_project.work_project_name"}],staticClass:"form-control col-10",attrs:{type:"text"},domProps:{value:t.work_project.work_project_name},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.work_project.work_project_id?t.updateProject():t.addProject()},input:function(e){e.target.composing||t.$set(t.work_project,"work_project_name",e.target.value)}}})]),t.work_project.work_project_id?a("button",{staticClass:"btn btn-warning btn-block mt-3",attrs:{disabled:t.loading_add_project},on:{click:function(e){return t.updateProject()}}},[a("i",{staticClass:"fa fa-save"})]):a("button",{staticClass:"btn btn-success btn-block mt-3",attrs:{disabled:t.loading_add_project},on:{click:function(e){return t.addProject()}}},[a("i",{staticClass:"fa fa-plus"})])])])])])]),a("div",{staticClass:"modal text-dark animate__animated animate__fadeInDown animate__faster",attrs:{id:"mdl_staff_project"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("button",{staticClass:"btn btn-danger",attrs:{"data-dismiss":"modal"},on:{click:function(e){return t.clearStaffProject()}}},[t._v("×")]),a("h5",{staticClass:"mt-2"},[t._v("Staff Projects")])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"container-fluid px-0"},[a("div",{staticClass:"row pe-4"},[a("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Staff: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.staff_project.st_id,expression:"staff_project.st_id"}],staticClass:"form-control col-10",attrs:{disabled:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.staff_project,"st_id",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}}),t._l(t.staffs,(function(e){return a("option",{key:e.st_id,domProps:{value:e.st_id}},[t._v(" "+t._s(e.staff_name)+" ")])}))],2)]),a("div",{staticClass:"row pe-4 mt-3"},[a("label",{staticClass:"col-2 mt-2 ps-4"},[t._v("Project: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.staff_project.work_project_id,expression:"staff_project.work_project_id"}],staticClass:"form-control col-10",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.staff_project,"work_project_id",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}}),t._l(t.work_projects,(function(e){return a("option",{key:e.work_project_id,domProps:{value:e.work_project_id}},[t._v(" "+t._s(e.work_project_name)+" ")])}))],2)]),a("button",{staticClass:"btn btn-warning btn-block mt-3",attrs:{disabled:!t.staff_project.staff_work_project_id},on:{click:function(e){return t.updateStaffProject()}}},[a("i",{staticClass:"fa fa-save"})]),a("v-data-table",{staticClass:"mt-3",attrs:{headers:t.staff_work_project_headers,items:t.staff_projects},scopedSlots:t._u([{key:"item.actions",fn:function(e){var o=e.item;return[a("v-btn",{attrs:{icon:"",color:"primary"},on:{click:function(e){return t.selectSingleStaffProject(o)}}},[a("v-icon",[t._v(" mdi-pencil ")])],1)]}}],null,!0)})],1)])])])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-sm-flex justify-content-between align-items-center mb-4"},[a("h3",{staticClass:"text-dark mb-0"},[t._v(" Projects")])])}],s=a("1ab6"),c={name:"work_projects",data(){return{work_project:{work_project_id:null,work_project_name:null,work_project_status:null},work_projects:[],loading_add_project:!1,headers:[{text:"Project",align:"start",sortable:!0,value:"work_project_name"},{text:"Status",align:"start",sortable:!0,value:"work_project_status"},{text:"Actions",align:"start",sortable:!1,value:"actions"}],staff_work_project_headers:[{text:"Staff",align:"start",sortable:!0,value:"staff_name"},{text:"Project",align:"start",sortable:!0,value:"work_project_name"},{text:"Actions",align:"start",sortable:!1,value:"actions"}],staff_projects:[],staff_project:{staff_work_project_id:null,st_id:null,work_project_id:null},staffs:[]}},beforeCreate(){Object(s["a"])("workProjects")},created(){this.$http.post("/staff/getData").then(({data:t})=>{this.staffs=t.filter(t=>"1"==t.show_staff).sort((t,e)=>t.staff_sort_code-e.staff_sort_code)})},mounted(){this.$http.post("/work_projects/getData").then(t=>{this.work_projects=t.data,this.$http.get("/work_projects/getStaffProjects").then(t=>{this.staff_projects=t.data})})},methods:{clearProject(){this.work_project={work_project_id:null,work_project_name:null,work_project_status:"enabled"}},addProject(){this.work_project.work_project_name?(this.loading_add_project=!0,this.$http.post("/work_projects/addProject",this.work_project).then(t=>{this.work_projects.push({work_project_id:t.data.work_project_id,work_project_name:this.work_project.work_project_name,work_project_status:this.work_project.work_project_status}),this.clearProject()}).catch(()=>{alert("Failed to add project")}).finally(()=>{this.loading_add_project=!1})):alert("Please enter project name")},getSingleProject(t){this.work_project=JSON.parse(JSON.stringify(t))},updateProject(){this.work_project.work_project_name?(this.loading_add_project=!0,this.$http.patch("/work_projects/updateProject/"+this.work_project.work_project_id,this.work_project).then(()=>{const t=this.work_projects.findIndex(t=>t.work_project_id==this.work_project.work_project_id);this.$set(this.work_projects,t,JSON.parse(JSON.stringify(this.work_project))),alert("Project updated successfully")}).catch(()=>{alert("Failed to update project")}).finally(()=>{this.loading_add_project=!1})):alert("Please enter project name")},deleteProject(t){const e=confirm("Are you sure you want to delete this project?");e&&this.$http.delete("/work_projects/deleteProject/"+t.work_project_id).then(()=>{this.work_projects=this.work_projects.filter(e=>e.work_project_id!=t)}).catch(()=>{alert("Failed, Project may be used in other records")})},updateStatus(t,e){if("enabled"==e){const t=confirm("Are you sure you want to enable this project?");if(!t)return}else{const t=confirm("Are you sure you want to disable this project?");if(!t)return}this.$http.patch("/work_projects/updateStatus/"+t,{work_project_status:e}).then(()=>{const a=this.work_projects.findIndex(e=>e.work_project_id==t);this.$set(this.work_projects[a],"work_project_status",e)}).catch(()=>{alert("Failed to update status")})},clearStaffProject(){this.staff_project={staff_work_project_id:null,st_id:null,work_project_id:null}},selectSingleStaffProject(t){this.staff_project=JSON.parse(JSON.stringify(t))},updateStaffProject(){this.staff_project.st_id&&this.staff_project.work_project_id?this.$http.patch("/work_projects/updateStaffProject/"+this.staff_project.staff_work_project_id,{work_project_id:this.staff_project.work_project_id}).then(()=>{const t=this.staff_projects.findIndex(t=>t.staff_work_project_id==this.staff_project.staff_work_project_id);this.$set(this.staff_projects[t],"work_project_id",this.staff_project.work_project_id),this.$set(this.staff_projects[t],"work_project_name",this.work_projects.find(t=>t.work_project_id==this.staff_project.work_project_id).work_project_name),alert("Staff project updated successfully")}).catch(()=>{alert("Failed to update staff project")}):alert("Please select staff and project")}}},i=c,n=a("2877"),l=a("6544"),_=a.n(l),d=a("8336"),p=a("8fea"),f=a("132d"),j=Object(n["a"])(i,o,r,!1,null,null,null);e["default"]=j.exports;_()(j,{VBtn:d["a"],VDataTable:p["a"],VIcon:f["a"]})}}]);
//# sourceMappingURL=chunk-2d2161f4.1dcf0964.js.map